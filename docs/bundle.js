(e=>{"use strict";function t(e=new URLSearchParams(location.search)){return[...e.entries()].reduce(((e,[t,r])=>(e[t]=r,e)),{})}e.ENDPOINT_ESI="https://esi.evetech.net/dev",e.THOUSAND=1e3,e.MILLION=1e6,e.BILLION=1e9,e.TRILLION=1e12,e.parseNumber=function(t){const r=t?.toString?.();if(!r)return;if(/[0-9., ]k$/i.test(r))return u()*e.THOUSAND;if(/[0-9., ]m$/i.test(r))return u()*e.MILLION;if(/[0-9., ]b$/i.test(r))return u()*e.BILLION;if(/[0-9., ]t$/i.test(r))return u()*e.TRILLION;return u();function u(){const e=r.replace(/,/g,".").replace(/[^0-9.]/g,"");return parseFloat(parseFloat(e).toFixed(2))||void 0}},e.humaniseNumber=function(t=0,r){const u=Math.abs(t);if(u>=e.TRILLION)return`${e.formatNumber(t/e.TRILLION)} trillion ${r||""}`.trim();if(u>=e.BILLION)return`${e.formatNumber(t/e.BILLION)} billion ${r||""}`.trim();if(u>=e.MILLION)return`${e.formatNumber(t/e.MILLION)} million ${r||""}`.trim();if(u>=e.THOUSAND)return`${e.formatNumber(t/e.THOUSAND)} thousand ${r||""}`.trim();return`${e.formatNumber(t)} ${r||""}`.trim()},e.formatNumber=function(t=0){const r=e.parseNumber(t)||"",[u,n]=r.toString().split(/[,.]+/),s=[...u].reverse().reduce(((e,t,r)=>r%3?e.concat(t):e.concat(" ",t)),[]).reverse().join("").trim(),o=n?.slice?.(0,2);return o?`${s}.${o}`:`${s}`},window.addEventListener("DOMContentLoaded",(function(){const r={calculator:e.Calculator(t()),assets:e.Assets({onSubmit:function(e){const t={volume:e.volume,collateral:e.price,...r.calculator.getJumps()};r.calculator.prepareQuote(t),r.calculator.formatInputValues()}})};document.getElementById("ViewBody").replaceChildren(r.assets.render(),r.calculator.render())}),{once:!0,passive:!0})})(window.R={}),(e=>{"use strict";const t=document.getElementById("templateCalculator");e.Calculator=(r={})=>{const u=document.importNode(t.content,!0).firstChild,n={inputs:u.querySelectorAll("input"),route:u.querySelector(".Calculator-route"),quote:u.querySelector(".Calculator-quote")};return u.addEventListener("submit",(e=>{e.preventDefault()})),[...n.inputs].forEach((t=>{t.addEventListener("focus",(()=>t.select()),{passive:!0}),t.addEventListener("keyup",(()=>s(function(e){return[...e.elements].reduce(((e,t)=>t?.name?(e[t.name]=t.value,e):e),{})}(u))),{passive:!0}),t.addEventListener("blur",(t=>function({target:t}){t.value=e.formatNumber(t.value)}(t)),{passive:!0})})),s(r),{prepareQuote:s,formatInputValues:function(){[...n.inputs].forEach((t=>{t.value=e.formatNumber(t.value)}))},render:function(){return u},getJumps:function(){return{jumps:e.parseNumber(u.jumps.value)||0,jumpsLowsec:e.parseNumber(u.jumpsLowsec.value)||0,jumpsNullsec:e.parseNumber(u.jumpsNullsec.value)||0}}};function s(t={}){const r={volume:e.parseNumber(t.volume)||0,collateral:e.parseNumber(t.collateral)||0,jumps:e.parseNumber(t.jumps)||0,jumpsLowsec:e.parseNumber(t.jumpsLowsec)||0,jumpsNullsec:e.parseNumber(t.jumpsNullsec)||0};Object.entries(t).forEach((([e,t])=>{u[e].value=t})),n.quote.textContent=e.humaniseNumber(function({volume:e,collateral:t,jumps:r,jumpsLowsec:u,jumpsNullsec:n}){const s={volume:e||0,collateral:t||0,jumps:r||0,jumpsLowsec:u||0,jumpsNullsec:n||0},o=function({volume:e}){return 1e5+e/Math.sqrt(e)*1e3||0}(s),a=function({volume:e,collateral:t}){return Math.sqrt(.001*e+Math.sqrt(.001*t))||0}(s),c=function({jumps:e,jumpsLowsec:t,jumpsNullsec:r}){const u=.5*(e-t-r),n=1.5*t,s=3*r;return Math.sqrt(e)*((u+n+s)/e)||0}(s);return o*a*c}(r),"ISK")}}})(window.R),(e=>{"use strict";const t=document.getElementById("templateAssets"),r=/^([^\t]+)/,u=/\t([^\t]*)\t/,n=/\t([^\t]+)m3\t/,s=/\t([^\t]+)ISK/;e.Assets=(o={})=>{const a=document.importNode(t.content,!0).firstChild,c={input:a.querySelector(".Assets-input"),doSubmit:a.querySelector(".Assets-doSubmit")};return a.addEventListener("submit",l),{render:function(){return a},calculateTotals:l};function l(t){t?.preventDefault?.();const a=function(t=""){return t.split("\n").filter((e=>!!e.trim().length)).map((t=>function(t=""){const o=t.match(r)?.[1]||"N/A",a=t.match(u)?.[1]||"1",c=t.match(n)?.[1],l=t.match(s)?.[1];return{name:o,quantity:e.parseNumber(a),volume:e.parseNumber(c),price:e.parseNumber(l)}}(t)))}(c.input.value),{quantity:l,volume:i,price:m}=function(e=[]){return e.reduce(((e,t)=>(e.quantity+=t.quantity||0,e.volume+=t.volume||0,e.price+=t.price||0,e)),{quantity:0,volume:0,price:0})}(a);return o.onSubmit({quantity:l,volume:i,price:m})}}})(window.R);
